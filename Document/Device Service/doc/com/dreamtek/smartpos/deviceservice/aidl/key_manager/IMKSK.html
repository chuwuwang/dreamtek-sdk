<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_382) on Tue Feb 25 17:46:30 CST 2025 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>IMKSK</title>
<meta name="date" content="2025-02-25">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="IMKSK";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6,"i11":6,"i12":6,"i13":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.dreamtek.smartpos.deviceservice.aidl.key_manager</div>
<h2 title="Interface IMKSK" class="title">Interface IMKSK</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.Default.html" title="class in com.dreamtek.smartpos.deviceservice.aidl.key_manager">IMKSK.Default</a>, <a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.Stub.html" title="class in com.dreamtek.smartpos.deviceservice.aidl.key_manager">IMKSK.Stub</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">IMKSK</span></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.Default.html" title="class in com.dreamtek.smartpos.deviceservice.aidl.key_manager">IMKSK.Default</a></span></code>
<div class="block">Default implementation for IMKSK.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.Stub.html" title="class in com.dreamtek.smartpos.deviceservice.aidl.key_manager">IMKSK.Stub</a></span></code>
<div class="block">Local-side IPC implementation stub class.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#calculateByMasterKey-int-int-int-byte:A-android.os.Bundle-">calculateByMasterKey</a></span>(int&nbsp;keyId,
                    int&nbsp;keyType,
                    int&nbsp;algorithmMode,
                    byte[]&nbsp;data,
                    android.os.Bundle&nbsp;extend)</code>
<div class="block">calculate by MSKey</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#calculateBySessionKey-int-int-int-int-int-byte:A-android.os.Bundle-">calculateBySessionKey</a></span>(int&nbsp;keyId,
                     int&nbsp;keyType,
                     int&nbsp;encAlg,
                     int&nbsp;encMode,
                     int&nbsp;encFlag,
                     byte[]&nbsp;data,
                     android.os.Bundle&nbsp;extend)</code>
<div class="block">encrypt data or decrypt data by data key</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#calculateData-int-int-byte:A-byte:A-byte:A-android.os.Bundle-">calculateData</a></span>(int&nbsp;mode,
             int&nbsp;desType,
             byte[]&nbsp;key,
             byte[]&nbsp;data,
             byte[]&nbsp;initVec,
             android.os.Bundle&nbsp;extend)</code>
<div class="block">encrypt or decrypt data</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#calculateMAC-int-int-byte:A-byte:A-int-android.os.Bundle-">calculateMAC</a></span>(int&nbsp;keyId,
            int&nbsp;type,
            byte[]&nbsp;CBCInitVec,
            byte[]&nbsp;data,
            int&nbsp;desType,
            android.os.Bundle&nbsp;extend)</code>
<div class="block">calcute the MAC with given type</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#clearKey-int-int-android.os.Bundle-">clearKey</a></span>(int&nbsp;keyId,
        int&nbsp;keyType,
        android.os.Bundle&nbsp;bundle)</code>
<div class="block">clear M/S key</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#encryptPinFormat0-int-int-byte:A-java.lang.String-">encryptPinFormat0</a></span>(int&nbsp;pinKeyId,
                 int&nbsp;desType,
                 byte[]&nbsp;cardNumber,
                 java.lang.String&nbsp;passwd)</code>
<div class="block">encrypt pinblock from cardnumber & passwd</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#getKeyKCV-int-int-">getKeyKCV</a></span>(int&nbsp;keyIndex,
         int&nbsp;keyType)</code>
<div class="block">Get the checkValue of key</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#getLastError--">getLastError</a></span>()</code>
<div class="block">get the last error</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#getRandom-byte-">getRandom</a></span>(byte&nbsp;length)</code>
<div class="block">get random data</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#isKeyExist-int-int-android.os.Bundle-">isKeyExist</a></span>(int&nbsp;keyId,
          int&nbsp;keyType,
          android.os.Bundle&nbsp;extend)</code>
<div class="block">Check if Key is exists</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#loadMasterKey-int-byte:A-int-byte:A-android.os.Bundle-">loadMasterKey</a></span>(int&nbsp;keyId,
             byte[]&nbsp;key,
             int&nbsp;algorithmType,
             byte[]&nbsp;checkValue,
             android.os.Bundle&nbsp;extend)</code>
<div class="block">load the encrypted master key given Algorithm Type</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#loadPlainMasterKey-int-byte:A-int-byte:A-">loadPlainMasterKey</a></span>(int&nbsp;keyId,
                  byte[]&nbsp;key,
                  int&nbsp;algorithmType,
                  byte[]&nbsp;checkValue)</code>
<div class="block">load the plain master key given the algorithm Type (support ECB\CBC)</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#loadSessionKey-int-int-int-int-byte:A-byte:A-android.os.Bundle-">loadSessionKey</a></span>(int&nbsp;keyType,
              int&nbsp;mkId,
              int&nbsp;wkId,
              int&nbsp;decKeyType,
              byte[]&nbsp;key,
              byte[]&nbsp;checkValue,
              android.os.Bundle&nbsp;extend)</code>
<div class="block">load the work key given decrypt type</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/dreamtek/smartpos/deviceservice/aidl/key_manager/IMKSK.html#loadTEK-int-byte:A-int-byte:A-android.os.Bundle-">loadTEK</a></span>(int&nbsp;keyId,
       byte[]&nbsp;key,
       int&nbsp;algorithmType,
       byte[]&nbsp;checkValue,
       android.os.Bundle&nbsp;extend)</code>
<div class="block">load TEK key with Algorithm Type given

 TEK is the transfer key to encrypt master key</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="isKeyExist-int-int-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isKeyExist</h4>
<pre>boolean&nbsp;isKeyExist(int&nbsp;keyId,
                   int&nbsp;keyType,
                   android.os.Bundle&nbsp;extend)
            throws android.os.RemoteException</pre>
<div class="block">Check if Key is exists</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - the id (index 0~254) of the key</dd>
<dd><code>keyType</code> - <ul>
 <li>0x00 MASTER(main) key</li>
 <li>0x01 MAC key</li>
 <li>0x02 PIN(work) key</li>
 <li>0x03 TD key</li>
 <li>0x04 TEK</li>
 <li>0x10 (AES) MASTER key</li>
 <li>0x11 (AES) MAC key</li>
 <li>0x12 (AES) PIN key</li>
 <li>0x13 (AES) TD key</li>
 <li>0x14 (AES)TEK</li>
 </ul></dd>
<dd><code>extend</code> - - extend param for the future</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true for exist, false for not exists</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="clearKey-int-int-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearKey</h4>
<pre>boolean&nbsp;clearKey(int&nbsp;keyId,
                 int&nbsp;keyType,
                 android.os.Bundle&nbsp;bundle)
          throws android.os.RemoteException</pre>
<div class="block">clear M/S key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - clear key id</dd>
<dd><code>keyType</code> - <ul>
 <li> 0x00-DES MK</li>
 <li> 0x01-SM4 MK</li>
 <li> 0x02-AES MK</li>
 <li> 0x10-DES PIN</li>
 <li> 0x11-SM4 PIN</li>
 <li> 0x12-AES PIN</li>
 <li> 0x20-DES MAC</li>
 <li> 0x21-SM4 MAC</li>
 <li> 0x22-AES MAC</li>
 <li> 0x30-DES DATA</li>
 <li> 0x31-SM4 DATA</li>
 <li> 0x32-AES DATA</li>
 <li> 0x40-DES TEK</li>
 <li> 0x41-AES TEK</li>
 </ul></dd>
<dd><code>extend</code> - - extend param for the future</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="loadTEK-int-byte:A-int-byte:A-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadTEK</h4>
<pre>boolean&nbsp;loadTEK(int&nbsp;keyId,
                byte[]&nbsp;key,
                int&nbsp;algorithmType,
                byte[]&nbsp;checkValue,
                android.os.Bundle&nbsp;extend)
         throws android.os.RemoteException</pre>
<div class="block">load TEK key with Algorithm Type given

 TEK is the transfer key to encrypt master key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - the id (index, 0 to 254)</dd>
<dd><code>key</code> - the key</dd>
<dd><code>algorithmType<BR></code> - |---0x01-3des encrypted key <BR>
     |---0x02-3des plain key <BR>
     |---0x03-SM4 encrypte key <BR>
     |---0x04-SM4 plain key <BR>
     |---0x05-AES encrypted key <BR>
     |---0x06-AES plain key
     |---0x81-CBC 3des encrypted key <BR>
     |---0x82-CBC 3des plain key <BR>
     |---0x83-CBC SM4 encrypte key <BR>
     |---0x84-CBC SM4 plain key <BR>
     |---0x85-CBC AES encrypted key <BR>
     |---0x86-CBC AES plain key</dd>
<dd><code>checkValue</code> - the check value</dd>
<dd><code>extend</code> - - extend param
 <ul>
     <li>isCBCType(boolean) judge the mk encrypt mode whether is CBC mode(default false)</li>
     <li>initVec(byte[]) cbc initVec(default 16byte 0)</li>
 </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true on success, false on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="loadMasterKey-int-byte:A-int-byte:A-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadMasterKey</h4>
<pre>boolean&nbsp;loadMasterKey(int&nbsp;keyId,
                      byte[]&nbsp;key,
                      int&nbsp;algorithmType,
                      byte[]&nbsp;checkValue,
                      android.os.Bundle&nbsp;extend)
               throws android.os.RemoteException</pre>
<div class="block">load the encrypted master key given Algorithm Type</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - the id (index, 0 to 254)</dd>
<dd><code>key</code> - the encrypted key</dd>
<dd><code>algorithmType</code> - 0x01-3des algorithm<BR> 0x03-SM4 algorithm<BR> 0x05-AES algorithm<BR> 0x81-3des(cbc)<BR> 0x83-SM4(cbc)<BR> 0x85-AES(cbc)<BR></dd>
<dd><code>check</code> - value (default NULL)</dd>
<dd><code>extend</code> - - extend param
 <ul>
     <li>isCBCType(boolean) judge the mk encrypt mode whether is CBC mode(default false)</li>
     <li>initVec(byte[]) cbc initVec(default 16byte 0)</li>
     <li>isMasterEncMasterMode(boolean) master key can encrypt master key, if pos has loaded Master key</li>
     <li>decryptKeyIndex(int) (index 0 to 254)Decrypt key index. Will use the KeyId if not set and after that the last key will be overwritten.</li>
 </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true for success, false for failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="loadPlainMasterKey-int-byte:A-int-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadPlainMasterKey</h4>
<pre>boolean&nbsp;loadPlainMasterKey(int&nbsp;keyId,
                           byte[]&nbsp;key,
                           int&nbsp;algorithmType,
                           byte[]&nbsp;checkValue)
                    throws android.os.RemoteException</pre>
<div class="block">load the plain master key given the algorithm Type (support ECB\CBC)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - the id (index)</dd>
<dd><code>key</code> - the key</dd>
<dd><code>algorithmType</code> - 0x02-3des ecb algorithm<BR> 0x04-SM4 ecb algorithm<BR> 0x06-AES ecb algorithm<BR>
                    0x82-3des cbc algorithm<BR> 0x84-SM4 cbc algorithm<BR> 0x86-AES cbc algorithm<BR></dd>
<dd><code>checkValue</code> - the check value (default NULL)</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true on success, false on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="loadSessionKey-int-int-int-int-byte:A-byte:A-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadSessionKey</h4>
<pre>boolean&nbsp;loadSessionKey(int&nbsp;keyType,
                       int&nbsp;mkId,
                       int&nbsp;wkId,
                       int&nbsp;decKeyType,
                       byte[]&nbsp;key,
                       byte[]&nbsp;checkValue,
                       android.os.Bundle&nbsp;extend)
                throws android.os.RemoteException</pre>
<div class="block">load the work key given decrypt type</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyType</code> - select the workkey type<BR>
     |---1-MAC key, 2-PIN key, 3-TD key<BR>
     |---5-(SM4)MAC key, 6-(SM4)PIN key, 7-(SM4)TD key<BR>
     |---9-(AES)MAC key, 10-(AES)PIN key, 11-(AES)TD key<BR></dd>
<dd><code>mkId</code> - the id of master key for decrypt work key</dd>
<dd><code>wkId</code> - set the workkey id (index 0~254)</dd>
<dd><code>decKeyType</code> - select decrypt key type<BR>
     |---0x00-3DES master key<BR>
     |---0x01-transport key<BR>
     |---0x02-SM4 master key<BR>
     |---0x03-AES master key<BR>
     |---0x04-SM4 transport key<BR>
     |---0x05-AES transport key<BR>
     |---0x80-CBC 3DES master key<BR>
     |---0x81-CBC transport key<BR>
     |---0x82-CBC SM4 master key<BR>
     |---0x83-CBC AES master key<BR>
     |---0x84-CBC SM4 transport key<BR>
     |---0x85-CBC AES transport key<BR></dd>
<dd><code>encrypt</code> - key</dd>
<dd><code>checkValue</code> - check value (null for none)</dd>
<dd><code>extend</code> - - extend param
 <ul>
     <li>isCBCType(boolean) judge the mk encrypt mode whether is CBC mode(default false)</li>
     <li>initVec(byte[]) cbc initVec(default 16byte 0)</li>
 </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true on success, false on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="calculateMAC-int-int-byte:A-byte:A-int-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateMAC</h4>
<pre>byte[]&nbsp;calculateMAC(int&nbsp;keyId,
                    int&nbsp;type,
                    byte[]&nbsp;CBCInitVec,
                    byte[]&nbsp;data,
                    int&nbsp;desType,
                    android.os.Bundle&nbsp;extend)
             throws android.os.RemoteException</pre>
<div class="block">calcute the MAC with given type</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - the index of MAC KEY(0~254)</dd>
<dd><code>type</code> - Calculation mode 0x00-MAC X99; 0x01-MAC X919; 0x02-ECB (CUP standard ECB algorithm); 0x03-MAC 9606; 0x04-CBC MAC calculation</dd>
<dd><code>CBCInitVec</code> - - CBC initial vector. fixed length 8, can be null, default 8 bytes 0x00</dd>
<dd><code>data</code> - the source date</dd>
<dd><code>desType</code> - encrypt type<BR>
 <b style="text-decoration:line-through;">|--0x00-des</b><BR>
 |--0x01-3des<BR>
 |--0x02-sm4<BR>
 |--0x03-aes<BR></dd>
<dd><code>extend</code> - - extend param for the future</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the mac value, null means failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="calculateData-int-int-byte:A-byte:A-byte:A-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateData</h4>
<pre>byte[]&nbsp;calculateData(int&nbsp;mode,
                     int&nbsp;desType,
                     byte[]&nbsp;key,
                     byte[]&nbsp;data,
                     byte[]&nbsp;initVec,
                     android.os.Bundle&nbsp;extend)
              throws android.os.RemoteException</pre>
<div class="block">encrypt or decrypt data</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mode</code> - the mode of encrypt or decrypt
 <ul>
 <li>0x00 MK/SK ECB encrypt </li>
 <li>0x01 MK/SK ECB decrypt </li>
 <li>0x02 MK/SK CBC encrypt </li>
 <li>0x03 MK/SK CBC decrypt </li>
 </ul></dd>
<dd><code>desType</code> - the type of encrypt or decrypt
 <ul>
 <li>TYPE_DES - 0x00 DES Type </li>
 <li>TYPE_3DES - 0x01 3DES Type(EBC) </li>
 <li>TYPE_SM4 - 0x02 SM4 Type </li>
 <li>TYPE_AES - 0x03 AES Type</li>
 </ul></dd>
<dd><code>key</code> - the source key</dd>
<dd><code>data</code> - the source date</dd>
<dd><code>initVec</code> - 3des cbc init vector</dd>
<dd><code>extend</code> - - extend param for the future</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the encrypted or decrypted data, null means failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="calculateBySessionKey-int-int-int-int-int-byte:A-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateBySessionKey</h4>
<pre>byte[]&nbsp;calculateBySessionKey(int&nbsp;keyId,
                             int&nbsp;keyType,
                             int&nbsp;encAlg,
                             int&nbsp;encMode,
                             int&nbsp;encFlag,
                             byte[]&nbsp;data,
                             android.os.Bundle&nbsp;extend)
                      throws android.os.RemoteException</pre>
<div class="block">encrypt data or decrypt data by data key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - - data key index(0~254)</dd>
<dd><code>keyType</code> - - key type
     |---0x01 data key<BR>
     |---0x02 mac key<BR>
     <b style="text-decoration:line-through;">|---0x03 pin key</b><BR></dd>
<dd><code>encAlg-</code> - encryption algorithm<BR>
     |---0x01 3DES<BR>
     |---0x02 SM4<BR>
     |---0x03 AES<BR></dd>
<dd><code>encMode</code> - - encryption mode of operation<BR>
     |--0x01 ECB<BR>
     |--0x02 CBC<BR></dd>
<dd><code>encFlag</code> - - encryption flag<BR>
     |--0x00 encrypt<BR>
     |--0x01 decrypt<BR></dd>
<dd><code>data</code> - - data</dd>
<dd><code>extend</code> - - extend param
 <ul>
     <li>initVec(byte[]) cbc initVec(default null)</li>
 </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the result of encrypt data or decrypt data;</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="calculateByMasterKey-int-int-int-byte:A-android.os.Bundle-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateByMasterKey</h4>
<pre>byte[]&nbsp;calculateByMasterKey(int&nbsp;keyId,
                            int&nbsp;keyType,
                            int&nbsp;algorithmMode,
                            byte[]&nbsp;data,
                            android.os.Bundle&nbsp;extend)
                     throws android.os.RemoteException</pre>
<div class="block">calculate by MSKey</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - - data key index(0~254)</dd>
<dd><code>keyType</code> - - key type
     |---0x01 3DES master key<BR>
     |---0x02 SM4 master key<BR>
     |---0x03 AES master key<BR></dd>
<dd><code>algorithmMode</code> - - encryption algorithm<BR>
     |---0x00 encrypt ECB<BR>
     |---0x01 decrypt ECB<BR>
     |---0x02 encrypt CBC<BR>
     |---0x03 decrypt CBC<BR></dd>
<dd><code>data</code> - - data</dd>
<dd><code>extend</code> - - extend param
 <ul>
     <li>initVec(byte[]) cbc initVec(default null if not set)</li>
 </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the result of encrypt data or decrypt data;</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="getLastError--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastError</h4>
<pre>java.lang.String&nbsp;getLastError()
                       throws android.os.RemoteException</pre>
<div class="block">get the last error</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the description of the last error</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="getKeyKCV-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getKeyKCV</h4>
<pre>byte[]&nbsp;getKeyKCV(int&nbsp;keyIndex,
                 int&nbsp;keyType)
          throws android.os.RemoteException</pre>
<div class="block">Get the checkValue of key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyId</code> - - the index of key</dd>
<dd><code>keyType</code> - <BR>
                <ul>
                <li>0x01 Data key</li>
                <li>0x02 PIN key</li>
                <li>0x03 MAC key</li>
                <li>0x04 transfer key</li>
                <li>0x05 Master key</li>
                <li>0x11 (SM4)Data key</li>
                <li>0x12 (SM4)PIN key</li>
                <li>0x13 (SM4)MAC key</li>
                <li>0x14 (SM4)transfer key</li>
                <li>0x15 (SM4)Master key</li>
                <li>0x21 (AES)Data key</li>
                <li>0x22 (AES)PIN key</li>
                <li>0x23 (AES)MAC key</li>
                <li>0x24 (AES)transfer key</li>
                <li>0x25 (AES)Master key</li>
                </ul></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the check value of the key</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="encryptPinFormat0-int-int-byte:A-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptPinFormat0</h4>
<pre>byte[]&nbsp;encryptPinFormat0(int&nbsp;pinKeyId,
                         int&nbsp;desType,
                         byte[]&nbsp;cardNumber,
                         java.lang.String&nbsp;passwd)
                  throws android.os.RemoteException</pre>
<div class="block">encrypt pinblock from cardnumber & passwd</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pinKeyId</code> - the index of PIN KEY(0~254)</dd>
<dd><code>desType</code> - calculate type <BR>
   |----0x01 MK/SK + 3DES (default)<BR>
   |----0x02 MK/SK + AES<BR>
   |----0x03 MK/SK + SM4<BR></dd>
<dd><code>cardNumber</code> - - card number (ascii type, such as "1234", you should input byte[4] = "31 32 33 34")</dd>
<dd><code>passws-</code> - plain password (String type, such as "1234", you should input String = "1234")</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
<a name="getRandom-byte-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getRandom</h4>
<pre>byte[]&nbsp;getRandom(byte&nbsp;length)
          throws android.os.RemoteException</pre>
<div class="block">get random data</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>length</code> - - length of random data(1~255)</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>result of random data;</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>android.os.RemoteException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</body>
</html>
